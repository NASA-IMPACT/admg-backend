{% extends "api_app/base.html" %}
{% load render_table from django_tables2 %}
{% load humanize %}

{% block page %}

<div class="container-fluid">
  <div class="row mt-4 mb-5">
    <div class="col-auto mr-auto">
      <div class="row">
        <div>
          <h1> Welcome, {{request.user.username |title }}.</h1>
        </div>
      </div>
    </div>
    <div class="col-auto">
      <a class="btn btn-dark" href="/admin/drafts/add/campaign">Add New Campaign + </a>
    </div>
    <div class="row" style="margin-left: .5rem;">
      <div class="col card" style="min-width:12rem; margin-right:6px;">
        <div class="card-body" style="padding:.3rem;">
          <small class="text-uppercase" style="font-weight: bold;">
            Campaigns: 
          </small>
          <p style="font-size:x-large; font-weight: bold; margin-bottom: 0;">
            {{ published_counts.campaign }}
          </p>
        </div>
      </div>
      <div class="col card" style="min-width:12rem; margin-right: 6px;">
        <div class="card-body" style="padding:.3rem;">
          <small class="text-uppercase" style="font-weight: bold;">
            Deployments: 
          </small>
          <p style="font-size:x-large; font-weight: bold; margin-bottom: 0;">
            {{ change_counts.deployment }}
          </p>
        </div>
      </div>
      <div class="col card" style="min-width:12rem; margin-right: 6px;">
        <div class="card-body" style="padding:.3rem;">
          <small class="text-uppercase" style="font-weight: bold;">
            Platforms: 
          </small>
          <p style="font-size:x-large; font-weight: bold; margin-bottom: 0;">
            {{ change_counts.platform }}
          </p>
        </div>
      </div>
      <div class="col card" style="min-width:12rem;">
        <div class="card-body" style="padding:.3rem;">
          <small class="text-uppercase" style="font-weight: bold;">
            Instruments: 
          </small>
          <p style="font-size:x-large; font-weight: bold; margin-bottom: 0;">
            {{ change_counts.instrument }}
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<h3>Recent Draft Campaigns</h3>
<div class="container-fluid">
  {% render_table table %}
</div>

<h3>Recent Activities</h3>
<ul>
  {% for activity in activity_list %}
  <li>
    <span title={{ activity.date|date:"c" }}>{{ activity.date | naturaltime }}</span>:
    {{ activity.get_action_display }}
    <a href="{% url 'change-form' activity.change.uuid %}">
      {{ activity.change.model_name }}
      {% firstof activity.change.update.short_name activity.change.update.long_name activity.change.uuid %}
    </a>
    {% if activity.user %} by {{ activity.user }}{% endif %}
  </li>
  {% endfor %}
</ul>
{% endblock %}